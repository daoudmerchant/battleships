(this.webpackJsonpbattleships=this.webpackJsonpbattleships||[]).push([[0],{167:function(t,e,n){},377:function(t,e,n){},378:function(t,e,n){"use strict";n.r(e);var r,i,c,a,o,s,u,l,d,h,p,f,b,j,O,g,v,m=n(1),x=n.n(m),y=n(155),S=n.n(y),k=(n(167),n(5)),w=n(9),C=n(10),D=n(156),T=n.n(D),I=(n(168),function(t){for(var e=[],n=[],r=0;r<t;r++){for(var i=[],c=0;c<t;c++)i.push({containsShip:!1,isHit:!1});e.push(i)}var a=function(t,e){var n=Object(k.a)(e,2),r=n[0],i=n[1];return t[r]&&t[r][i]};return{get current(){return e},receiveAttack:function(t){var n=Object(k.a)(t,2),r=n[0],i=n[1];return!e[r][i].isHit&&(e[r][i].containsShip&&e[r][i].hitShip(),e[r][i].isHit=!0,!0)},insertShip:function(r){var i=r.ship,c=r.isVertical,o=r.coordinates,s=r.isConfirmed,u=s?e:T()(e),l=Object(k.a)(o,2),d=l[0],h=l[1],p=!0;(c&&d+i.length>t||!c&&h+i.length>t)&&(p=!1);var f=function(t,e){for(var n=0;n<i.length;n++){e(t,[c?d+n:d,c?h:h+n],n)}};return f(u,(function(t,e){var n=Object(k.a)(e,2),r=n[0],i=n[1],c=a(t,[r,i]);c&&!c.containsShip||(p=!1)})),s&&p?(f(u,(function(t,e,n){var r=Object(k.a)(e,2),c=r[0],a=r[1];t[c][a]={containsShip:!0,isHit:!1,hitShip:function(){i.hit(n)},get shipIsSunk(){return i.isSunk}}})),n.push((function(){return i.isSunk}))):s||f(u,(function(t,e){var n=Object(k.a)(e,2),r=n[0],i=n[1];a(t,[r,i])&&(t[r][i]=p?{containsShip:!0,isDummy:!0,isValid:!0}:{containsShip:!0,isDummy:!0,isValid:!1})})),{newGameboard:u,isValid:p}},get isOver(){return!!n.length&&n.every((function(t){return t()}))}}}),H=function(t){var e={length:t,isHit:new Array(t).fill(!1),sunk:!1},n=function(){e.sunk||e.isHit.every((function(t){return t}))&&(e.sunk=!0);return e.sunk};return{length:t,hit:function(t){if(t>e.length-1)throw new Error("Index longer than ship");return e.isHit[t]=!0,n()},get hits(){return e.isHit},get isSunk(){return n()}}},P=n(113),V=function(){var t=function(){var t=function(t,e){if(t.length){var n=t.filter(e);return n.length&&n}if("object"===typeof t)return e(t);throw new Error("Only accepts arrays or objects")},e=function(t){return t};return{hitButNotSunk:function(e){return t(e,(function(t){return t.boardsquare.isHit&&t.boardsquare.containsShip&&!t.boardsquare.shipIsSunk}))},unhit:function(e){return t(e,(function(t){return!t.boardsquare.isHit}))},hit:function(e){return t(e,(function(t){return t.boardsquare.isHit}))},missed:function(e){return t(e,(function(t){return t.boardsquare.isHit&&!t.boardsquare.containsShip}))},truthy:function(n){return t(n,e)},allTruthy:function(t){return t.every(e)}}}(),e=function(){var t=function(t,e){var n=Object(k.a)(e,2),r=n[0],i=n[1];return t[r]&&t[r][i]};return{left:function(e,n){var r=Object(k.a)(n,2),i=r[0],c=r[1];return t(e,[i,c-1])&&{coordinates:[i,c-1],boardsquare:e[i][c-1]}},right:function(e,n){var r=Object(k.a)(n,2),i=r[0],c=r[1];return t(e,[i,c+1])&&{coordinates:[i,c+1],boardsquare:e[i][c+1]}},up:function(e,n){var r=Object(k.a)(n,2),i=r[0],c=r[1];return t(e,[i-1,c])&&{coordinates:[i-1,c],boardsquare:e[i-1][c]}},down:function(e,n){var r=Object(k.a)(n,2),i=r[0],c=r[1];return t(e,[i+1,c])&&{coordinates:[i+1,c],boardsquare:e[i+1][c]}}}}(),n=function(n){var r,i=void 0,c=void 0,a=[],o=Object(P.a)(n.entries());try{for(o.s();!(r=o.n()).done;){var s,u=Object(k.a)(r.value,2),l=u[0],d=u[1],h=Object(P.a)(d.entries());try{for(h.s();!(s=h.n()).done;){var p=Object(k.a)(s.value,2),f=p[0],b=p[1];if(b.isHit&&b.containsShip&&!b.shipIsSunk){var j=e.right(n,[l,f]),O=e.left(n,[l,f]),g=e.up(n,[l,f]),v=e.down(n,[l,f]),m=[j,O,g,v],x=t.truthy(m),y=t.unhit(x);if(!y.length)continue;if(!t.hitButNotSunk(x).length){i=y.map((function(t){return t.coordinates}));break}for(var S=[O,j,v,g],w=[],C=0;C<4;C++){var D=m[C],T=S[C];if(t.allTruthy([D,T])&&t.unhit(D)&&t.hitButNotSunk(T))w.push(D.coordinates);else if(D&&t.hitButNotSunk(D)&&(!T||t.hit(T))){c||(c=[]);var I=t.unhit(x);I&&I.forEach((function(t){return c.push(t.coordinates)}))}}if(w.length){i=w;break}}else b.isHit||a.push([l,f])}}catch(H){h.e(H)}finally{h.f()}if(i)break}}catch(H){o.e(H)}finally{o.f()}return i||c||a},r=function(t){return 1===t.length?t[0]:t[Math.floor(Math.random()*t.length)]},i=function(t){var e=t.currentGameboard,n=t.shipLength,r=t.isVertical,i=[];return e.forEach((function(t,e){t.forEach((function(t,n){var c=r?n:e;if(!t.containsShip){var a,o,s,u=r?[e-1,n]:[e,n-1];i[c]&&(s=i[c],a=s[s.length-1],o=u,Array.isArray(a)&&Array.isArray(o)&&a.length===o.length&&a.every((function(t,e){return t===o[e]})))?i[c].push([e,n]):i[c]=[[e,n]]}}))})),i.filter((function(t){return t.length>=n})).map((function(t){return t.slice(0,1-n)})).flat()};return{takeTurn:function(t){var e=r(n(t.current));t.receiveAttack(e)},placeOwnShip:function(t,e){var n=r([!0,!1]),c=i({currentGameboard:t.current,shipLength:e.length,isVertical:n}),a={ship:e,isVertical:n,coordinates:r(c),isConfirmed:!0};t.insertShip(a)},test:{checkFor:t,getAdjacentSquare:e,processBoard:n,findShipPlacements:i}}},A=n(2),E=C.a.div(r||(r=Object(w.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  background-color: bisque;\n"]))),L=Object(C.a)(E)(i||(i=Object(w.a)(["\n  z-index: 2;\n  @media (hover: none) {\n    display: none;\n  }\n  @media (pointer: coarse) {\n    display: none;\n  }\n"]))),q=Object(C.a)(E)(c||(c=Object(w.a)(["\n  z-index: 1;\n  @media (orientation: portrait) {\n    display: none;\n  }\n"]))),N=C.a.span(a||(a=Object(w.a)(["\n  font-weight: bold;\n"]))),z=Object(m.memo)((function(){return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsxs)(L,{children:[Object(A.jsx)("h1",{style:{fontSize:"3rem"},children:"Sorry!"}),Object(A.jsx)("p",{style:{fontSize:"2rem"},children:["This app has been optimised for ",Object(A.jsx)(N,{children:"touch devices"}),"."]})]}),Object(A.jsx)(q,{children:Object(A.jsx)("p",{style:{fontSize:"2.5rem"},children:["Please hold your device in ",Object(A.jsx)(N,{children:"portrait orientation"}),"."]})})]})})),G=C.a.div(o||(o=Object(w.a)(["\n  height: 10%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: white;\n"]))),W=Object(m.memo)((function(){return Object(A.jsx)(G,{children:Object(A.jsx)("h1",{children:"Battleships"})})})),B=n(161),R=n(383),F=n(384),M=C.a.div(s||(s=Object(w.a)(["\n  height: 100%;\n  width: 100%;\n  border: 1px solid lightgrey;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]))),J=function(t){var e=t.cell,n=void 0===e?{}:e,r=t.contents,i=t.coordinates,c=t.placeShip,a=t.setHoverGameboard,o=t.reportDrop,s=t.placeLastShip,u=t.takeTurn,l=t.shipsPlaced,d=function(t,e){return t.hasOwnProperty(e)?t[e]:void 0},h=d(n,"containsShip"),p=d(n,"isDummy"),f=d(n,"isValid"),b=d(n,"isHit"),j=d(n,"shipIsSunk"),O=Object(F.a)((function(){return{accept:["SHIP-VERTICAL","SHIP-HORIZONTAL"],drop:function(t,e){if(i){var n=e.getItemType();c(i,"SHIP-VERTICAL"===n)?(o.confirm(!0),s&&s()):o.deny()}},hover:function(t,e){if(r)o.deny();else{var n=e.getItemType();a(i,"SHIP-VERTICAL"===n),o.confirm(!1)}}}})),g=Object(k.a)(O,2)[1],v=l&&!1===b||r?"transparent":j?"lightgrey":h&&(b&&l||!p&&!l)?"red":h&&p&&f?"lightgreen":h&&p&&!1===f?"orange":"rgb(215, 245, 255)",m=r?{backgroundColor:v,border:"none"}:{backgroundColor:v};return Object(A.jsx)(M,{ref:g,style:m,onClick:u?function(){u(i)}:void 0,children:r})},Z=Object(m.createContext)(),K=C.a.div(u||(u=Object(w.a)(["\n  display: grid;\n  margin: 0 auto;\n  grid-gap: 1px;\n"]))),Q=function(t){var e=t.gameboard,n=t.gridDisplayWidth,r=t.ship,i=t.placeShip,c=t.shipsPlaced,a=t.didDrop,o=t.setDidDrop,s=t.placeLastShip,u=t.incrementTurn,l=t.changeTurn,d=t.computerTurn,h=e.current.length,p=Object(m.useState)(e.current),f=Object(k.a)(p,2),b=f[0],j=f[1],O=Object(m.useContext)(Z).visible,g=Object(m.useMemo)((function(){for(var t=[],e=0;e<h;e++)t.push(String.fromCharCode(65+e));return t}),[h]),v=Object(m.useCallback)((function(){j(e.current)}),[e]);Object(m.useEffect)((function(){a||v()}),[a,v]);var x=function(t,n){var i=e.insertShip({ship:r,isVertical:n,coordinates:t,isConfirmed:!1});j(i.newGameboard)},y=function(t){e.receiveAttack(t)&&(u(),l())},S={confirm:function(t){o(!0),t&&u()},deny:function(){o(!1)}};return Object(A.jsxs)(K,{className:O?"fadeIn":"fadeOut",style:{gridTemplateRows:"repeat(".concat(h+1,", 1fr)"),gridTemplateColumns:"repeat(".concat(h+1,", 1fr)"),width:n,height:n},children:[Object(A.jsx)(J,{contents:" ",reportDrop:S}),g.map((function(t){return Object(A.jsx)(J,{contents:t,reportDrop:S},"letter".concat(t))})),b&&b.map((function(t,e){return t.map((function(t,n){return 0===n||n%(h+1)===0?Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(J,{contents:e+1,reportDrop:S},"num".concat(e+1)),Object(A.jsx)(J,{cell:t,coordinates:[e,n],placeShip:i,placeLastShip:s,setHoverGameboard:x,reportDrop:S,takeTurn:c&&!d?y:void 0,shipsPlaced:c,changeTurn:l},"square".concat(e,"-").concat(n))]}):Object(A.jsx)(J,{cell:t,coordinates:[e,n],placeShip:i,placeLastShip:s,setHoverGameboard:x,reportDrop:S,takeTurn:c&&!d?y:void 0,shipsPlaced:c},"square".concat(e,"-").concat(n))}))}))]})},U=n(385),X=n(162),Y=C.a.div(l||(l=Object(w.a)(["\n  background-color: red;\n  display: block;\n"]))),$=function(t){var e=t.ship,n=t.isVertical,r=t.width,i=t.gridDisplayWidth,c=t.setDidDrop,a=Object(U.a)((function(){return{type:n?"SHIP-VERTICAL":"SHIP-HORIZONTAL",collect:function(t){return{isDragging:!!t.isDragging()}},end:function(t,e){e.didDrop()||c(!1)}}})),o=Object(k.a)(a,2),s=o[0].isDragging,u=o[1],l="calc(".concat(i," / ").concat(r+1," * ").concat(e.length,")"),d="calc(".concat(i," / ").concat(r+1,")"),h=function(){var t=Object(X.a)(),e=t.display,r=t.style;return e?n?Object(A.jsx)(Y,{style:Object.assign(r,{width:d,height:l,backgroundColor:s?"red":"transparent"})}):Object(A.jsx)(Y,{style:Object.assign(r,{width:l,height:d,backgroundColor:s?"red":"transparent"})}):null};return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(Y,{ref:u,style:{width:n?d:l,height:n?l:d,backgroundColor:s?"transparent":"red"}})," ",Object(A.jsx)(h,{})]})},_=C.a.div(d||(d=Object(w.a)(["\n  width: 90vw;\n  height: min-content;\n  margin: 20px auto;\n"]))),tt=C.a.div(h||(h=Object(w.a)(["\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n"]))),et=C.a.p(p||(p=Object(w.a)(["\n  font-size: 1.5rem;\n"]))),nt=C.a.span(f||(f=Object(w.a)(["\n  font-weight: bold;\n"]))),rt=function(t){var e=t.ship,n=t.width,r=t.setDidDrop,i=t.gridDisplayWidth,c=Object(m.useContext)(Z).visible;return Object(A.jsxs)(_,{className:c?"fadeIn":"fadeOut",children:[Object(A.jsx)(et,{children:["Drag ",Object(A.jsx)(nt,{children:"either"})," ship on to the board"]}),Object(A.jsx)(tt,{children:e&&Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)($,{ship:e,width:n,gridDisplayWidth:i,setDidDrop:r,isVertical:!1}),Object(A.jsx)($,{ship:e,width:n,gridDisplayWidth:i,setDidDrop:r,isVertical:!0})]})})]})},it=C.a.p(b||(b=Object(w.a)(["\n  font-size: 1.2rem;\n  // margin: 1rem auto -5px;\n  font-weight: bold;\n"]))),ct="82vw",at=function(t){var e=t.game,n=t.isGameOver,r=t.placeShip,i=t.placeLastShip,c=t.shipsPlaced,a=t.changeTurn,o=t.computerTurn,s=Object(m.useState)(!0),u=Object(k.a)(s,2),l=u[0],d=u[1],h=Object(m.useState)(0),p=Object(k.a)(h,2),f=p[0],b=p[1],j=Object(m.useContext)(Z).visible,O=c?{marginTop:"10vh"}:void 0;return Object(A.jsxs)(R.a,{backend:B.a,children:[Object(A.jsx)(it,{className:j?"fadeIn":"fadeOut",style:O,children:0===e.turn?"Player 1":e.player2?"Computer":"Player 2"}),n?e.gameboard.map((function(t,e){return alert("Game over"),Object(A.jsx)(Q,{gameboard:t,length:"40vw"},"board".concat(e))})):Object(A.jsx)(Q,{gridDisplayWidth:ct,gameboard:e.gameboard[e.turn],shipsPlaced:c,ship:e.ships[e.turn][0],placeShip:r,didDrop:l,setDidDrop:d,placeLastShip:i,incrementTurn:function(){b((function(t){return t+1}))},changeTurn:a,computerTurn:o},"".concat(e.turn).concat(f)),c&&!o&&Object(A.jsx)("p",{className:j?"fadeIn":"fadeOut",children:"Tap to take a turn"}),!c&&Object(A.jsx)(rt,{ship:e.ships[e.turn][0],gridDisplayWidth:ct,width:e.gameboard[e.turn].current.length,setDidDrop:d})]})},ot=C.a.div(j||(j=Object(w.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 90%;\n  justify-content: space-evenly;\n"]))),st=C.a.div(O||(O=Object(w.a)(["\n  display: flex;\n  margin: 0 15vw;\n  justify-content: center;\n  align-items: center;\n  flex-grow: 1;\n"]))),ut=C.a.button(g||(g=Object(w.a)(["\n  display: block;\n  font-size: 1.2rem;\n  padding: 0;\n  flex-grow: 1;\n  margin: 0 10vw 8vw;\n  border: 1px solid transparent;\n  border-radius: 10px;\n  -webkit-box-shadow: -5px 5px 9px 1px rgba(0, 0, 0, 0.3);\n  box-shadow: -5px 5px 9px 1px rgba(0, 0, 0, 0.2);\n"]))),lt=function(t){var e=t.data,n=e.title,r=e.options,i=Object(m.useState)(!1),c=Object(k.a)(i,2),a=c[0],o=c[1],s=Object(m.useContext)(Z).visible;return Object(A.jsxs)(ot,{children:[Object(A.jsx)(st,{className:s?"fadeIn":"fadeOut",children:Object(A.jsx)("h2",{children:n})}),r.map((function(t,e){var n=200+100*e,r={transition:"bottom 0.3s linear ".concat(n,"ms, opacity 0.3s linear ").concat(n,"ms, background-color 0.15s linear"),backgroundColor:a===e?"#c4ffce":"white"};return Object(A.jsx)(ut,{onClick:function(){o(e),t.reportClick(),setTimeout((function(){o(!1)}),1200)},className:s?"zip center":"zip down",style:r,children:t.text},t.key)}))]})},dt=(n(377),C.a.span(v||(v=Object(w.a)(["\n  font-weight: bold;\n"]))));var ht=function(){var t=Object(m.useState)(void 0),e=Object(k.a)(t,2),n=e[0],r=e[1],i=Object(m.useState)(void 0),c=Object(k.a)(i,2),a=c[0],o=c[1],s=Object(m.useState)(null),u=Object(k.a)(s,2),l=u[0],d=u[1],h=Object(m.useState)(!1),p=Object(k.a)(h,2),f=p[0],b=p[1],j=Object(m.useState)(!1),O=Object(k.a)(j,2),g=O[0],v=O[1],x=Object(m.useState)(null),y=Object(k.a)(x,2),S=y[0],w=y[1],C=Object(m.useState)(!1),D=Object(k.a)(C,2),T=D[0],P=D[1],E=Object(m.useState)(!1),L=Object(k.a)(E,2),q=L[0],N=L[1],G={visible:T},B=Object(m.useCallback)((function(t){N(!0),setTimeout((function(){return P(!1)}),l?800:400),setTimeout((function(){N(!1),t()}),l?1500:1e3)}),[l]);Object(m.useEffect)((function(){T||q||setTimeout((function(){return P(!0)}),100)}),[T,q]),Object(m.useEffect)((function(){if(n&&void 0!==a){var t=function(t){return[5,4,3,3,2].slice((10-t)/2).map((function(t){return H(t)}))},e=[t(n),t(n)],r=a&&V(),i=I(n);if(a)for(;e[1].length;)r.placeOwnShip(i,e[1].pop());var c={player2:r,gameboard:[I(n),i],ships:e,turn:0};d(c),w(null)}}),[a,n]);var R=Object(m.useCallback)((function(){b(!0),d((function(t){var e=Object.assign({},t),n=Object(k.a)(t.gameboard,2),r=n[0],i=n[1];return e.gameboard=[i,r],e}))}),[]),F=Object(m.useCallback)((function(t,e){var n=e?0===t?"Congratulations, you won!":"Sorry, looks like you lost this time...":"Player ".concat(0===t?"1":"2"," is the winner!");w({title:n,options:[{reportClick:function(){return B((function(){return r(void 0),o(void 0),void b(!1)}))},text:"Let's go again!"}]})}),[B]),M=Object(m.useCallback)((function(){w(null);var t=l.gameboard.findIndex((function(t){return t.isOver}));t>-1?F(t,a):(0===l.turn&&a&&v(!0),d((function(t){var e=Object.assign({},t);return e.turn=t.turn?0:1,f||e.ships.every((function(t){return!t.length}))&&R(),e})))}),[l,R,F,a,f]),J=function(){if(!a||f||l.ships[0].length){if(!a){var t=0===l.turn?"2":"1";w({title:["It's Player ".concat(t,"'s turn!"),Object(A.jsx)("br",{}),Object(A.jsx)("br",{}),"Please pass the device."],options:[{reportClick:function(){return B((function(){return M()}))},text:[Object(A.jsx)(dt,{children:"Player ".concat(t)})," here!"],key:"P".concat(t)}]})}}else R()};return Object(m.useEffect)((function(){g&&setTimeout((function(){d((function(t){var e=Object.assign({},t);return e.player2.takeTurn(e.gameboard[1]),e})),B((function(){M()}))}),1e3),v(!1)}),[M,B]),Object(m.useEffect)((function(){}),[l]),Object(m.useEffect)((function(){n?void 0!==a||w({title:"Are you playing by yourself or with a friend?",options:[{reportClick:function(){return B((function(){return o(!0)}))},text:["Just me (",Object(A.jsx)(dt,{children:"1 player"}),")."],key:"1player"},{reportClick:function(){return B((function(){return o(!1)}))},text:["Got a friend here (",Object(A.jsx)(dt,{children:"2 players"}),")."],key:"2player"}]}):w({title:"Which board size would you like today?",options:[{reportClick:function(){return B((function(){return r(6)}))},text:["I'm in a rush, ",Object(A.jsx)(dt,{children:"6x6"})," please."],key:"6x6"},{reportClick:function(){return B((function(){return r(8)}))},text:["I've got time for an ",Object(A.jsx)(dt,{children:"8x8"})," board."],key:"8x8"},{reportClick:function(){return B((function(){return r(10)}))},text:["The classic - ",Object(A.jsx)(dt,{children:"10x10"}),"."],key:"10x10"}]})}),[n,a,B]),Object(A.jsxs)("div",{className:"App",children:[Object(A.jsx)(z,{}),Object(A.jsx)(W,{}),Object(A.jsxs)(Z.Provider,{value:G,children:[l&&!S&&Object(A.jsx)(at,{game:l,computerTurn:a&&1===l.turn,shipsPlaced:f,placeShip:l.ships[l.turn].length?function(t,e){var n;return d((function(r){var i=Object.assign({},r);return(n=i.gameboard[r.turn].insertShip({ship:i.ships[r.turn][0],isVertical:e,coordinates:t,isConfirmed:!0}).isValid)&&i.ships[r.turn].shift(),i})),n}:void 0,placeLastShip:1===l.ships[l.turn].length?function(){B((function(){return J()}))}:void 0,changeTurn:a?function(){return B((function(){return M()}))}:function(){return B((function(){return J()}))}}),S&&Object(A.jsx)(lt,{data:S})]})]})};S.a.render(Object(A.jsx)(x.a.StrictMode,{children:Object(A.jsx)(ht,{})}),document.getElementById("root"))}},[[378,1,2]]]);
//# sourceMappingURL=main.ed406e5b.chunk.js.map